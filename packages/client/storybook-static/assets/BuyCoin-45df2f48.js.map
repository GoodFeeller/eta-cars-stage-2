{"version":3,"file":"BuyCoin-45df2f48.js","sources":["../../src/hooks/useBuyCoin.ts","../../src/components/modal/add-coin-modal/buy-coin/BuyCoin.tsx"],"sourcesContent":["import { IProfileCoin, IProfileTotal } from '../service/ProfileTypes'\r\nimport { useContext, useState } from 'react'\r\nimport { AddContext } from '../providers/AddContext'\r\nimport { ICoin } from '../types/ICoin'\r\n\r\nfunction useBuyCoin(coin: ICoin) {\r\n  const [count, setCount] = useState<string>('0')\r\n  const { setCoin } = useContext(AddContext)\r\n  const buy = () => {\r\n    const profile = localStorage.getItem('//profile//')\r\n    const prev = localStorage.getItem(coin.id)\r\n    const newCoin: IProfileCoin = {\r\n      symbol: coin.symbol,\r\n      id: coin.id,\r\n      count: Number(count),\r\n      totalPrice: Number(count) * Number(coin.priceUsd),\r\n    }\r\n    if (prev != null) {\r\n      const oldState: IProfileCoin = JSON.parse(prev)\r\n      newCoin.totalPrice += oldState.totalPrice\r\n      newCoin.count += oldState.count\r\n    }\r\n    localStorage.setItem(coin.id, JSON.stringify(newCoin))\r\n    if (profile == null) {\r\n      const newProfile: IProfileTotal = {\r\n        id: [coin.id],\r\n        totalPrice: newCoin.totalPrice,\r\n      }\r\n      localStorage.setItem('//profile//', JSON.stringify(newProfile))\r\n    } else {\r\n      const oldProfile: IProfileTotal = JSON.parse(profile)\r\n      if (oldProfile.id.some((id) => id === coin.id))\r\n        localStorage.setItem(\r\n          '//profile//',\r\n          JSON.stringify({\r\n            totalPrice: oldProfile.totalPrice + newCoin.totalPrice,\r\n            id: oldProfile.id,\r\n          }),\r\n        )\r\n      else\r\n        localStorage.setItem(\r\n          '//profile//',\r\n          JSON.stringify({\r\n            totalPrice: oldProfile.totalPrice + newCoin.totalPrice,\r\n            id: [...oldProfile.id, coin.id],\r\n          }),\r\n        )\r\n    }\r\n    setCoin(null)\r\n    window.dispatchEvent(new Event('storage'))\r\n  }\r\n  return { count, setCount, buy }\r\n}\r\nexport default useBuyCoin\r\n","import { FunctionComponent, useEffect, useState } from 'react'\r\nimport styles from '../AddCoinModal.module.scss'\r\nimport useBuyCoin from '../../../../hooks/useBuyCoin'\r\nimport { ICoin } from '../../../../types/ICoin'\r\n\r\nconst BuyCoin: FunctionComponent<{ coin: ICoin }> = ({ coin }) => {\r\n  const [error, setError] = useState<boolean>(false)\r\n  const { count, setCount, buy } = useBuyCoin(coin)\r\n\r\n  useEffect(\r\n    () => setError(count.split('').some((e) => isNaN(Number.parseInt(e)))),\r\n    [count],\r\n  )\r\n  return (\r\n    <div className={styles.buyBlock}>\r\n      <input\r\n        name=\"Count\"\r\n        className={error ? styles.error : styles.correct}\r\n        type={'text'}\r\n        maxLength={4}\r\n        onChange={(e) => setCount(e.target.value)}\r\n        value={count}\r\n      />\r\n      <button onClick={() => buy()} disabled={error || count.length === 0}>\r\n        Buy\r\n      </button>\r\n    </div>\r\n  )\r\n}\r\nexport default BuyCoin\r\n"],"names":["useBuyCoin","coin","count","setCount","useState","setCoin","useContext","AddContext","profile","prev","newCoin","oldState","newProfile","oldProfile","id","BuyCoin","error","setError","buy","useEffect","e","jsxs","styles","jsx"],"mappings":"oWAKA,SAASA,EAAWC,EAAa,CAC/B,KAAM,CAACC,EAAOC,CAAQ,EAAIC,WAAiB,GAAG,EACxC,CAAE,QAAAC,CAAA,EAAYC,EAAA,WAAWC,CAAU,EA4ClC,MAAA,CAAE,MAAAL,EAAO,SAAAC,EAAU,IA3Cd,IAAM,CACV,MAAAK,EAAU,aAAa,QAAQ,aAAa,EAC5CC,EAAO,aAAa,QAAQR,EAAK,EAAE,EACnCS,EAAwB,CAC5B,OAAQT,EAAK,OACb,GAAIA,EAAK,GACT,MAAO,OAAOC,CAAK,EACnB,WAAY,OAAOA,CAAK,EAAI,OAAOD,EAAK,QAAQ,CAAA,EAElD,GAAIQ,GAAQ,KAAM,CACV,MAAAE,EAAyB,KAAK,MAAMF,CAAI,EAC9CC,EAAQ,YAAcC,EAAS,WAC/BD,EAAQ,OAASC,EAAS,KAC5B,CAEA,GADA,aAAa,QAAQV,EAAK,GAAI,KAAK,UAAUS,CAAO,CAAC,EACjDF,GAAW,KAAM,CACnB,MAAMI,EAA4B,CAChC,GAAI,CAACX,EAAK,EAAE,EACZ,WAAYS,EAAQ,UAAA,EAEtB,aAAa,QAAQ,cAAe,KAAK,UAAUE,CAAU,CAAC,CAAA,KACzD,CACC,MAAAC,EAA4B,KAAK,MAAML,CAAO,EAChDK,EAAW,GAAG,KAAMC,GAAOA,IAAOb,EAAK,EAAE,EAC9B,aAAA,QACX,cACA,KAAK,UAAU,CACb,WAAYY,EAAW,WAAaH,EAAQ,WAC5C,GAAIG,EAAW,EAAA,CAChB,CAAA,EAGU,aAAA,QACX,cACA,KAAK,UAAU,CACb,WAAYA,EAAW,WAAaH,EAAQ,WAC5C,GAAI,CAAC,GAAGG,EAAW,GAAIZ,EAAK,EAAE,CAAA,CAC/B,CAAA,CAEP,CACAI,EAAQ,IAAI,EACZ,OAAO,cAAc,IAAI,MAAM,SAAS,CAAC,CAAA,EAG7C,CC/CA,MAAAU,EAAA,CAAA,CAAA,KAAAd,KAAA,CACE,KAAA,CAAAe,EAAAC,CAAA,EAAAb,EAAA,SAAA,EAAA,EACA,CAAA,MAAAF,EAAA,SAAAC,EAAA,IAAAe,CAAA,EAAAlB,EAAAC,CAAA,EAEAkB,OAAAA,EAAA,UAAA,IAAAF,EAAAf,EAAA,MAAA,EAAA,EAAA,KAAAkB,GAAA,MAAA,OAAA,SAAAA,CAAA,CAAA,CAAA,CAAA,EACuE,CAAAlB,CAAA,CAC/D,EAERmB,EAAAA,KAAA,MAAA,CAAA,UAAAC,EAAA,SAAA,SAAA,CAEIC,EAAA,IAAA,QAAC,CAAA,KAAA,QACM,UAAAP,EAAAM,EAAA,MAAAA,EAAA,QACoC,KAAA,OACnC,UAAA,EACK,SAAAF,GAAAjB,EAAAiB,EAAA,OAAA,KAAA,EAC6B,MAAAlB,CACjC,CAAA,EACTqB,EAAAA,IAAA,SAAA,CAAA,QAAA,IAAAL,EAAA,EAAA,SAAAF,GAAAd,EAAA,SAAA,EAAA,SAAA,KAAA,CAAA,CAGA,CAAA,CAAA,CAGN"}